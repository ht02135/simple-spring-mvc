
https://digitalcloud.training/aws-security-group-vs-nacl-key-differences/
AWS Security Group vs NACL – Key Differences

///////////

Security Group Key Features

Security groups are tied to an instance. This can be either an EC2 instance, ECS cluster or an RDS database instance – providing routing rules and acting as a firewall for the resources contained within the security group.  With a security group, you have to purposely assign a security group to the instances – if you don’t want them to use the default security group.

The default security group allows all traffic outbound by default, but no inbound traffic. 

Security groups are stateful in nature. As a result, any changes applicable to an incoming rule will also be automatically applied to the outgoing rule in the same way. For example, allowing an incoming port 80 will automatically open the outgoing port 80

The only rule set that can be used in security groups is the Allow rule set. 

////////////////

Network Access Control Lists (NACLS)

Network ACLs exist on an interact at the subnet level, so any instance in the subnet with an associated NACL will automatically follow the rules of the NACL.

Network ACLs are stateless. Consequently, any changes made to an incoming rule will not be reflected in an outgoing rule. For example, if you allow an incoming port 80, you would also need to apply the rule for outgoing traffic.

Unlike a Security Group, NACLs support both allow and deny rules. By deny rules, you could explicitly deny a certain IP address to establish a connection; e.g. to block a specific known malicious IP address from establishing a connection to an EC2 Instance.

//////////////////////

https://www.reddit.com/r/aws/comments/cab816/difference_between_security_groups_route_tables/
Difference between Security Groups, Route Tables, and NACLs? 

1>routing table is tie to load balancing...
A route table is... well it’s a routing table that tells the network where to route traffic to if the destination isn’t within the same subnet. Same as a routing table on any host/network interface. You can route traffic to an interface or a gateway.

2>next security group (stateful firewall with in/out rule)
stateful means, if you say allow in for port 80, then you by default allow out for port 80.  it only has allow no deny...

A security group applies stateful network rules to traffic directed to an instance/interface. Stateful means it keeps track of outbound connections and allows the return traffic through automatically.

3>next nacl (stateless firewall with in/out traffic)
stateless means, you need separate in/out traffic
A network ACL applies to traffic heading in or out of a subnet, and the rules are stateless. This means you need to explicitly need to allow inbound and outbound traffic.

//////////////////////////
//////////////////////////

route table image
1>no port is involved
2>only has destination and target
3>Destination vs Target
Destination field specifies the pattern that a request must match with its destination address (IP or CIDR range).
Target field specifies where such a request should be routed

| destination | target  | status | propagation |
|0.0.0.0/16   | local   | Active | No          |  <-- default main route
|0.0.0.0/0    | igw-xyz | Active | No          |  <-- connect to igw

This will route any request with into-the-VPC destination to local targets in the VPC. If the pattern 10.0.0.0/16 is not met, the any-ipv4-address aka 0.0.0.0/0 will be considered and the request will be routed to the internet gateway you specified with ID your-igw-id.

//////////////////////////
//////////////////////////

NACL
port range is involved

NACL inbound
Source. [Inbound rules only] The source of the traffic (CIDR range)
https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml
6 	TCP 	Transmission Control

| rule# | type        | protocol | port range | source    | allow/deny |
| 100   | http 80     | tcp 6    | 80         | 0.0.0.0/0 | allow |
| 200   | https 443   | tcp 6    | 443        | 0.0.0.0/0 | allow |
| 300   | ssh 22      | tcp 6    | 22         | 0.0.0.0/0 | allow |
| *     | all traffic | all      | all        | 0.0.0.0/0 | deny  |

NACL outbound
Destination. [Outbound rules only] The destination for the traffic (CIDR range).

| rule# | type        | protocol | port range | destination  | allow/deny |
| 100   | http 80     | tcp 6    | 80         | 0.0.0.0/0    | allow |
| 200   | https 443   | tcp 6    | 443        | 0.0.0.0/0    | allow |
| 300   | ssh 22      | tcp 6    | 22         | 0.0.0.0/16   | allow |
| *     | all traffic | all      | all        | 0.0.0.0/0    | deny  |

//////////////////////////
//////////////////////////

Security groups are stateful in nature. As a result, any changes applicable to an incoming rule will also be automatically applied to the outgoing rule in the same way. For example, allowing an incoming port 80 will automatically open the outgoing port 80

note : i wonder if that just mean, only can edit inbound, because outbound is toss out..

security group is stableful

security group inbound

0.0.0.0/0 is the IPv4 everything - all possible IPv4 addresses.
::/0 is the IPv6 equivalent

| type  | protocol | port range | source                  | description |
| ssh   | tcp      | 22         | anywhere 0.0.0.0/0 ::/0 | admin access |
| http  | tcp      | 80         | anywhere 0.0.0.0/0 ::/0 | web traffic |
| https | tcp      | 443        | anywhere 0.0.0.0/0 ::/0 | secured web traffic |

i dont seem to be able to find image with security group outbound
note : i wonder if that just mean, only can edit inbound, because outbound is toss out. forget outbound part...

another thing, i think one firewall at security group should be sufficient.  not quite
sure what they want to achieve with nacl???

nacl = feels like duplicated effort for diminishing return...  which in investment world is NO NO NO...

but 2nd thought, if it hit nacl before hit security group, then it can save security group from dealing with request that can be knockoff in nacl? may be that is why for perf purpose. other than perf purpose i dont see how nacl is added additional security.  it really is dminishing return...

but 3rd thought, the instructor said nacl give you a default firewall in case you miss associate security group with instance, because nacl is subnet level which will apply to all instance in the subnet.  it is ok to screw up security group but nacl is your last defense...  ok if you say so :)  what about just dont mess up in first place?

//////////////////////////
//////////////////////////



